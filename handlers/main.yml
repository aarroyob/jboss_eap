- name: Add jboss-as Service
  sudo: true
  command: "chkconfig --add jboss-as-{{jboss_eap_mode}}.sh"
  notify:
    - Enable jboss-as Service
  tags:
    - jboss_eap

- name: Enable jboss-as Service
  sudo: true
  service: 
    name: "jboss-as-{{jboss_eap_mode}}.sh"
    enabled: yes
  notify:
    - Restart jboss-as Service
  tags:
    - jboss_eap

- name: Restart jboss-as Service
  sudo: true
  service: 
    name: "jboss-as-{{jboss_eap_mode}}"
    state: restarted
  tags:
    - jboss_eap

# Sanity test if everything was setup right and JBoss is running
- name: Verify jboss-as is running
  wait_for: port="8080" host="{{ jboss_eap_bind_web_address }}" timeout=120
  notify: Check jboss-as is available

- name: Check jboss-as is available
  uri:
    url: "http://{{jboss_eap_bind_web_address}}:8080"
